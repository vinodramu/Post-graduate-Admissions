<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>USER REGISTRATION</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<style>
  body {
    background-image: url('assets/university.jpg');
    font-family: Arial, sans-serif;
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center center;
    height: 100vh;
    margin: 0;
    padding: 0;
  }
</style>

<body>
  <div class="container">
    <div class="form-container">
      <h1>USER REGISTRATION</h1>
      <form [formGroup]="form" (ngSubmit)="onUserFormSubmit()" class="form-group">
        <div class="form-group">
          <label for="name">Name</label>
          <input id="name" formControlName="username" class="form-control" />
          <div *ngIf="form.get('username')?.invalid && form.get('username')?.touched" class="text-danger">
            Name is required.
          </div>
        </div>

        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" formControlName="password" class="form-control" />
          <div *ngIf="form.get('password')?.invalid && form.get('password')?.touched" class="text-danger">
            Password is required and must be at least 8 characters long.
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirm Password</label>
          <input type="password" id="confirmPassword" formControlName="confirmpassword" class="form-control" />
          <div *ngIf="form.get('confirmpassword')?.hasError('passwordMismatch') && form.get('confirmpassword')?.touched"
            class="text-danger">
            Passwords must match.
          </div>
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <input id="email" formControlName="email" class="form-control" />
          <div *ngIf="form.get('email')?.invalid && form.get('email')?.touched" class="text-danger">
            A valid email is required.
          </div>
        </div>

        <div class="form-group">
          <label for="phone">Phone</label>
          <input id="phone" formControlName="phone" class="form-control" />
          <div *ngIf="form.get('phone')?.invalid && form.get('phone')?.touched" class="text-danger">
            A valid phone number is required (10 digits).
          </div>
        </div>

        <button type="submit" class="btn btn-primary">Register</button>
      </form>
    </div>

    <!-- OTP Popup -->
    <div *ngIf="showOtpPopup" class="modal-backdrop fade show"></div>
    <div *ngIf="showOtpPopup" class="modal fade show d-block" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" *ngIf="!showResendOtp">Enter OTP</h5>
            <h5 class="modal-title" *ngIf="showResendOtp">Check your email for OTP </h5>
            <button type="button" class="close" (click)="showOtpPopup = false">
              <span>&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form [formGroup]="otpForm" (ngSubmit)="onOtpSubmit()" class="form-group">
              <div class="form-group">
                <label for="otp">OTP</label>
                <input id="otp" formControlName="otp" class="form-control" />
                <div *ngIf="otpForm.get('otp')?.invalid && otpForm.get('otp')?.touched" class="text-danger">
                  OTP must be 6 digits.
                </div>
              </div>
              <button type="submit" class="btn btn-secondary my-2" style="background-color: #4caf50;">Submit
                OTP</button>
            </form>
            <button (click)="ResendOTP()" class="btn btn-secondary my-2" style="background-color: #071af1;">Resend
              OTP</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Success Modal -->
    <div *ngIf="showSuccessPopup" class="modal-backdrop fade show"></div>
    <div *ngIf="showSuccessPopup" class="modal fade show d-block" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Success</h5>
            <button type="button" class="close" (click)="showSuccessPopup = false">
              <span>&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <h3 style="color: #00ff08;">User Registered successfully!!! Click on ok to login</h3>
            <button type="button" class="btn btn-primary my-2" (click)="OtpVarifiedSuccessfully()">OK</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Error Modal -->
    <div *ngIf="showErrorPopup" class="modal-backdrop fade show"></div>
    <div *ngIf="showErrorPopup" class="modal fade show d-block" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Error</h5>
            <button type="button" class="close" (click)="showErrorPopup = false">
              <span>&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <h3 style="color: #f91505;">OTP verification failed. Please try again.</h3>
            <button type="button" class="btn btn-primary my-2" (click)="closeErrorPopup()">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>

</html>